!function t(e,i,n){function o(a,s){if(!i[a]){if(!e[a]){var u="function"==typeof require&&require;if(!s&&u)return u(a,!0);if(r)return r(a,!0);var l=new Error("Cannot find module '"+a+"'");throw l.code="MODULE_NOT_FOUND",l}var c=i[a]={exports:{}};e[a][0].call(c.exports,function(t){var i=e[a][1][t];return o(i?i:t)},c,c.exports,t,e,i,n)}return i[a].exports}for(var r="function"==typeof require&&require,a=0;a<n.length;a++)o(n[a]);return o}({1:[function(t,e,i){(function(i){function n(t,e,i){for(var n="",o=i;o>0;o--){var r=0,a=1<<o-1;0!=(t&a)&&r++,0!=(e&a)&&(r+=2),n+=r.toString()}return n}function o(t){var e=t.split(",");return[e[1],e[0],e[3],e[2]]}var r="undefined"!=typeof window?window.L:void 0!==i?i.L:null,a=t("fetch-jsonp"),s=t("bbox-intersect"),u=["Aerial","AerialWithLabels","Road"];r.TileLayer.Bing=r.TileLayer.extend({options:{bingMapsKey:null,imagerySet:"Aerial",culture:"en-US",minZoom:1},statics:{METADATA_URL:"https://dev.virtualearth.net/REST/v1/Imagery/Metadata/{imagerySet}?key={bingMapsKey}&include=ImageryProviders",POINT_METADATA_URL:"https://dev.virtualearth.net/REST/v1/Imagery/Metadata/{imagerySet}/{lat},{lng}?zl={z}&key={bingMapsKey}"},initialize:function(t){if("string"==typeof t&&(t={bingMapsKey:t}),t&&t.BingMapsKey&&(t.bingMapsKey=t.BingMapsKey,console.warn("use options.bingMapsKey instead of options.BingMapsKey")),!t||!t.bingMapsKey)throw new Error("Must supply options.BingMapsKey");if(t=r.setOptions(this,t),u.indexOf(t.imagerySet)<0)throw new Error("'"+t.imagerySet+"' is an invalid imagerySet, see https://github.com/gmaclennan/leaflet-bing-layer#parameters");t.minZoom=Math.max(1,t.minZoom);var e=r.Util.template(r.TileLayer.Bing.METADATA_URL,{bingMapsKey:this.options.bingMapsKey,imagerySet:this.options.imagerySet});this._imageryProviders=[],this._attributions=[],this._fetch=a(e,{jsonpCallback:"jsonp"}).then(function(t){return t.json()}).then(this._metaDataOnLoad.bind(this)).catch(console.error.bind(console)),r.Browser.android||this.on("tileunload",this._onTileRemove)},createTile:function(t,e){var i=document.createElement("img");return r.DomEvent.on(i,"load",r.bind(this._tileOnLoad,this,e,i)),r.DomEvent.on(i,"error",r.bind(this._tileOnError,this,e,i)),this.options.crossOrigin&&(i.crossOrigin=""),i.alt="",this._url?i.src=this.getTileUrl(t):this._fetch.then(function(){i.src=this.getTileUrl(t)}.bind(this)).catch(function(t){console.error(t),e(t)}),i},getTileUrl:function(t){t.z>this.options.maxNativeZoom&&(t.z=this.options.maxNativeZoom);var e=n(t.x,t.y,t.z);return r.Util.template(this._url,{quadkey:e,subdomain:this._getSubdomain(t),culture:this.options.culture})},onAdd:function(t){t.on("moveend",this._updateAttribution,this),r.TileLayer.prototype.onAdd.call(this,t),this._attributions.forEach(function(e){t.attributionControl.addAttribution(e)})},onRemove:function(t){t.off("moveend",this._updateAttribution,this),this._attributions.forEach(function(e){t.attributionControl.removeAttribution(e)}),r.TileLayer.prototype.onRemove.call(this,t)},getMetaData:function(t,e){return this._map||t&&e?(t=t||this._map.getCenter(),e=e||this._map.getZoom(),a(r.Util.template(r.TileLayer.Bing.POINT_METADATA_URL,{bingMapsKey:this.options.bingMapsKey,imagerySet:this.options.imagerySet,z:e,lat:t.lat,lng:t.lng}),{jsonpCallback:"jsonp"}).then(function(t){return t.json()}).catch(console.error.bind(console))):Promise.reject(new Error("If layer is not attached to map, you must provide LatLng and zoom"))},_metaDataOnLoad:function(t){if(200!==t.statusCode)throw new Error("Bing Imagery Metadata error: \n"+JSON.stringify(t,null,"  "));var e=t.resourceSets[0].resources[0];return this._url=e.imageUrl,this._imageryProviders=e.imageryProviders,this.options.subdomains=e.imageUrlSubdomains,this._updateAttribution(),Promise.resolve()},_updateAttribution:function(){var t=this._map;if(t&&t.attributionControl){var e=t.getZoom(),i=o(t.getBounds().toBBoxString());this._fetch.then(function(){var n=this._getAttributions(i,e),o=this._attributions;n.forEach(function(e){o.indexOf(e)>-1||t.attributionControl.addAttribution(e)}),o.filter(function(e){n.indexOf(e)>-1||t.attributionControl.removeAttribution(e)}),this._attributions=n}.bind(this))}},_getAttributions:function(t,e){return this._imageryProviders.reduce(function(i,n){for(var o=0;o<n.coverageAreas.length;o++)if(s(t,n.coverageAreas[o].bbox)&&e>=n.coverageAreas[o].zoomMin&&e<=n.coverageAreas[o].zoomMax)return i.push(n.attribution),i;return i},[])}}),r.tileLayer.bing=function(t){return new r.TileLayer.Bing(t)},e.exports=r.TileLayer.Bing}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"bbox-intersect":2,"fetch-jsonp":3}],2:[function(t,e,i){e.exports=function(t,e){return!(t[0]>e[2]||t[2]<e[0]||t[3]<e[1]||t[1]>e[3])}},{}],3:[function(t,e,i){!function(t,n){if("function"==typeof define&&define.amd)define(["exports","module"],n);else if(void 0!==i&&void 0!==e)n(i,e);else{var o={exports:{}};n(o.exports,o),t.fetchJsonp=o.exports}}(this,function(t,e){"use strict";function i(){return"jsonp_"+Date.now()+"_"+Math.ceil(1e5*Math.random())}function n(t){try{delete window[t]}catch(e){window[t]=void 0}}function o(t){var e=document.getElementById(t);document.getElementsByTagName("head")[0].removeChild(e)}function r(t){var e=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],r=t,s=e.timeout||a.timeout,u=e.jsonpCallback||a.jsonpCallback,l=void 0;return new Promise(function(a,c){var d=e.jsonpCallbackFunction||i(),f=u+"_"+d;window[d]=function(t){a({ok:!0,json:function(){return Promise.resolve(t)}}),l&&clearTimeout(l),o(f),n(d)},r+=r.indexOf("?")===-1?"?":"&";var h=document.createElement("script");h.setAttribute("src",""+r+u+"="+d),h.id=f,document.getElementsByTagName("head")[0].appendChild(h),l=setTimeout(function(){c(new Error("JSONP request to "+t+" timed out")),n(d),o(f)},s)})}var a={timeout:5e3,jsonpCallback:"callback",jsonpCallbackFunction:null};e.exports=r})},{}]},{},[1]);